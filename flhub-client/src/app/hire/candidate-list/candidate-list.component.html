<mat-spinner *ngIf="candidatesLoading$ | async; else candidates"></mat-spinner>
<ng-template #candidates>
  <div class="d-flex flex-row justify-content-between">
    <button type="button" mat-raised-button color="primary" (click)="update()">Update candidates</button>
    <div class="d-flex flex-row justify-content-end">
      <form [formGroup]="filterForm">
        <mat-checkbox formControlName="showBad" (change)="onFilterChange()">Show bad candidates</mat-checkbox>
      </form>
      <ng-container *ngIf=""></ng-container>
      <button mat-button [matMenuTriggerFor]="menu">Sort By</button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item *ngFor="let sortingKey of sortingKeys" (click)="sortBy(sortingKey)">
          <ng-container *ngIf="sortBy$ | async; let sortBy">
            <ng-container *ngIf="sortBy.key === sortingKey">
              <mat-icon *ngIf="sortBy.direction === 'desc'; else asc">arrow_downward</mat-icon>
              <ng-template #asc>
                <mat-icon>arrow_upward</mat-icon>
              </ng-template>
            </ng-container>
          </ng-container>
          <span>{{ sortingKey }}</span>
        </button>
        <button mat-menu-item (click)="sortBy(null)">Reset</button>
      </mat-menu>
    </div>
  </div>
  <div *ngIf="candidates$ | async; let candidates; else: noCandidates">
    <ng-container *ngIf="candidates.length; else noCandidates">
      <app-candidate-list-item *ngFor="let candidate of page$ | async" [candidate]="candidate"></app-candidate-list-item>
      <mat-paginator
        [length]="candidates.length"
        [pageSize]="pageSize$ | async"
        [pageSizeOptions]="[5, 10, 25, 100]"
        [pageIndex]="pageIndex$ | async"
        (page)="onPageChanged($event)"
      ></mat-paginator>
    </ng-container>
  </div>
</ng-template>
<ng-template #noCandidates>
  <p>No candidates</p>
</ng-template>
